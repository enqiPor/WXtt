<template>
	    <div class="text_cont" id="text_cont">
			<div class="img_show">
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z1.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z2.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z3.png' alt="">
				</p>
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z4.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z5.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z6.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z7.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z8.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z9.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z10.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z11.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z12.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z13.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z13.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z13.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z16.png' alt="">
				</p>
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z17.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z18.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z18.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z20.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z21.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z22.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z23.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z24.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z25.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z26.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z27.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z28.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z29.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z29.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z31.png' alt="">
				</p>
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z32.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z33.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z34.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z35.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z36.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z37.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z38.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z39.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z40.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z41.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z42.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z43.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z44.png' alt="">
				</p>
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z45.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z46.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z47.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z48.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z49.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z50.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z51.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z52.png' alt="">
				</p>
				<p>
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z53.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z54.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z55.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z56.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z57.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z58.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z59.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z60.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z61.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z62.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z63.png' alt="">
					<img src='https://ingcare.oss-cn-beijing.aliyuncs.com/images/z64.png' alt="">
				</p>
				
			</div>
			<div class="mask" :class="maskActive" v-show="showType"></div>
	    </div>
</template>

<script>
	export default {
	  name: 'Home',
	  data () {
	      return {
	        startX: 0, // 鼠标开始点击的x坐标
	        startY: 0 ,
			index:0,
			showType:false,
			maskActive:'',
			appId:'',
			timestamp:'',
			nonceStr:'',
			signature:'',
			link:''
			}
	  },
	  methods: {
	    addHandler (element, type, handler) {
	        if (element.addEventListener) {
	          element.addEventListener(type, handler, false)
	        } else if (element.attachEvent) {
	          element.attachEvent('on' + type, handler)
	        } else {
	          element['on' + type] = handler
	        }
	      },
	    handleTouchEvent (event) {
	        switch (event.type) {
	          case 'touchstart':
	            this.startX = event.touches[0].pageX
	            this.startY = event.touches[0].pageY
	            break
	          case 'touchend':
	            var spanX = event.changedTouches[0].pageX - this.startX
	            var spanY = event.changedTouches[0].pageY - this.startY
	            // console.log('spanY', spanY)
	            if (spanY > 30) { // 向下
					this.$router.replace('/?type=1')
	            }
	            break
	        }
		},
		showTetx(){
			var thisObj=this;
			let imgLengt = $('.img_show p');
			let index = this.index;
			console.log(index)
			let timer=setInterval(function(){
				$('.img_show p').each(function(thisIndex){
					if(index == thisIndex){
						$(this).animate({opacity:"1"})
					}
				})
				index++;
				if(index == $('.img_show p').length){
					clearInterval(timer);
					setTimeout(function(){
						thisObj.showType=true;
						$('.mask').animate({
							opacity: 1
						})
						setTimeout(function(){
							thisObj.showType=false;
							thisObj.$router.replace('/userlist');
						},600);
					},2000)
				}
			},600)
		},
		GetQueryString(name) {
		    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
		    var r = window.location.search.substr(1).match(reg);
		    if (r != null) return unescape(r[2]); return null;
		}
	  },
	  created() {
		  if(this.GetQueryString("type") == "1"){
		  	this.$router.replace('/');
		  }
		  let highestTimeoutId = setTimeout(";");
	      for (let i = 0 ; i < highestTimeoutId ; i++) {
		    clearTimeout(i); 
		  }

	  },
	  mounted () {
		  var thisObj=this;
		  this.index = 0;
		  this.showType = true;
		  $('.mask').animate({
		  		opacity: 1
		  })
		  setTimeout(function(){
		  		$('.mask').animate({
		  			opacity: 0
		  		})
		  },400);
		  setTimeout(function(){
		  		this.showType=false;
		  },600);
		this.showTetx();
		//禁止页面下拉
		document.body.addEventListener('touchmove', function (e) {
	       e.preventDefault()
	    }, { passive: false })
		
		//上滑跳转
		let element = document.getElementById('text_cont')
	      this.addHandler(element, 'touchstart', this.handleTouchEvent)
	      this.addHandler(element, 'touchend', this.handleTouchEvent)
	      this.addHandler(element, 'touchmove', this.handleTouchEvent)
		  
		  //微信分享
		    this.$axios.get('http://weixin.ingclass.org/webstage/weixin/common/login/getShareInfo.do?platCode=gh&current_url='+encodeURIComponent(window.location.href)).then(({data}) => {
		  			thisObj.appId=data.appId;
		    		thisObj.timestamp=data.timestamp;
		    		thisObj.nonceStr=data.nonceStr;
		    		thisObj.signature=data.signature;
		    		thisObj.link=data.link;
		    });
			setTimeout(function(){
				//微信分享
				  let imgUrl=$("#hide_img").attr("src");
				  let shareTitle="99公益日，一起为自闭症孩子助力免费课";//分享title内容
				  let shareCont="你的每一次转发，都有一个命运将被改变";//分享内容
				  let shareLink=thisObj.link+"?type=1";//分享链接
				wx.config({
					debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
					appId: thisObj.appId, // 必填，公众号的唯一标识
					timestamp: thisObj.timestamp, // 必填，生成签名的时间戳
					nonceStr: thisObj.nonceStr, // 必填，生成签名的随机串
					signature: thisObj.signature,// 必填，签名，见附录1
					jsApiList: ['onMenuShareTimeline', 'updateAppMessageShareData',"onMenuShareQQ","onMenuShareQZone"] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
				});
				wx.ready(function(){
					//分享到朋友圈
					wx.onMenuShareTimeline({
						title: shareTitle, // 分享标题
						link: shareLink, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
						imgUrl: imgUrl, // 分享图标
						success: function () {
							// 用户确认分享后执行的回调函数
						},
						cancel: function () {
							// 用户取消分享后执行的回调函数
						}
					});
					//分享给朋友
					wx.updateAppMessageShareData({
						title: shareTitle, // 分享标题
						desc: shareCont, // 分享描述
						link: shareLink, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
						imgUrl: imgUrl, // 分享图标
						type: '', // 分享类型,music、video或link，不填默认为link
						dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
						success: function () {
							// 用户确认分享后执行的回调函数
						},
						cancel: function () {
							// 用户取消分享后执行的回调函数
						}
					});
					//分享到QQ
					wx.onMenuShareQQ({
						title: shareTitle, // 分享标题
						desc: shareCont, // 分享描述
						link: shareLink, // 分享链接
						imgUrl: imgUrl, // 分享图标
						success: function () {
							// 用户确认分享后执行的回调函数
						},
						cancel: function () {
							// 用户取消分享后执行的回调函数
						}
					});
					//分享到空间
					wx.onMenuShareQZone({
						title: shareTitle, // 分享标题
						desc: shareCont, // 分享描述
						link: shareLink, // 分享链接
						imgUrl: imgUrl, // 分享图标
						success: function () {
							// 用户确认分享后执行的回调函数
						},
						cancel: function () {
							// 用户取消分享后执行的回调函数
						}
					});
				});
			},1500)
	  }
	}
</script>

<style lang="scss">
	.text_cont{
		width: 100%;
		height: 100%;
		background: url(http://ingcare.oss-cn-beijing.aliyuncs.com/img-bg/xingqiu_bg1.jpg) no-repeat;
		background-size: 100% 100%;
	}
	.img_show{
		text-align: center;
		position: absolute;
		width: 100%;
		left: 0;
		top: 58px;
	}
	.img_show img{
		height: 18px;
		margin-left: 5px;
	}
	.img_show p{
		margin-top: 22px;
		opacity: 0;
	}
	.donghua p{
			display: inline-block;
			opacity: 0;
			margin-left: 10px;
		}
		.scaleUp-enter-active, .scaleUp-leave-active {
		   transition: all 1s linear;
		 }
		.scaleUp-leave-active {
		  background: #000;
		}
</style>
